{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MASHATE\\\\Desktop\\\\JS\\\\React\\\\frontend\\\\src\\\\pages\\\\OfferPage.js\";\nimport React, { Component } from 'react';\nimport ResponsiveNavBar from \"../Partials/Header\";\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class OfferPage extends Component {\n  constructor() {\n    super();\n\n    this.componentDidMount = () => {\n      this.fetchOffer();\n    };\n\n    this.fetchOffer = () => {\n      axios({\n        method: \"GET\",\n        url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/annonces/\" + this.state.id,\n        headers: {\n          \"Content-Type\": \"Application/json\"\n        }\n      }).then(res => {\n        if (res.status === 200) {\n          this.getOffer();\n          let [h, mm, s] = res.data.time.split(\"T\")[1].split('Z')[0].split(\":\");\n          let [y, m, d] = res.data.time.split(\"T\")[0].split(\"-\");\n          let time = new Date(y, m, d, h, mm, s).getTime();\n          this.setState({\n            offer: res.data,\n            date: res.data.date_depart.split('Z')[0].split(\"-\"),\n            time: new Date(res.data.time.split(\"T\")[0] + \" \" + res.data.time.split(\"T\")[1].split(\"Z\")[0])\n          });\n        }\n      });\n    };\n\n    this.ResrveOffer = () => {\n      let d = new Date().toLocaleTimeString();\n      const str = sessionStorage.getItem(\"userID\").split(\"@\")[1] + \"@\" + d + \"@\" + this.state.offer.con;\n      axios({\n        method: \"POST\",\n        url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/reservations\",\n        data: {\n          \"id_annonces\": this.state.id,\n          \"resId\": window.btoa(str),\n          \"userlogin\": sessionStorage.getItem(\"userID\").split(\"@\")[1]\n        },\n        headers: {\n          \"Content-Type\": \"Application/json\"\n        }\n      }).then(res => {\n        if (res.status !== 200) {\n          alert(\"Error: can't book X( \");\n        } else {\n          this.setState({\n            resId: res.data\n          });\n          axios({\n            method: \"PUT\",\n            url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/annonces\",\n            data: {\n              ville_depart: this.state.offer.ville_depart,\n              ville_arrivee: this.state.offer.ville_arrivee,\n              date_depart: this.state.offer.date_depart,\n              nombre_places: this.state.offer.nombre_places - 1,\n              prix: this.state.offer.prix,\n              con: this.state.offer.con,\n              id: this.state.offer.con,\n              id_annonces: this.state.offer.id_annonces\n            },\n            headers: {\n              \"Content-Type\": \"Application/json\"\n            }\n          }).then(res => {\n            if (res.status === 200) {\n              this.setState({\n                is_added: true\n              });\n              alert(\"Congrats, you booked your place in this ride :) \");\n              window.location.href = \"/ride/bookedOffer?resID=\" + this.state.resId;\n            }\n          });\n        }\n      });\n    };\n\n    this.getOffer = () => {\n      axios({\n        method: \"GET\",\n        url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/conducteurs/\" + this.state.offer.con,\n        headers: {\n          \"Content-Type\": \"Application/json\"\n        }\n      }).then(res => {\n        if (res.status !== 200) {\n          this.setState({\n            conducteur: res.data\n          });\n        }\n      });\n    };\n\n    this.state = {\n      id: new URLSearchParams(window.location.search).get('id'),\n      offer: {},\n      conducteur: {},\n      date: [],\n      time: new Date(),\n      HMS: [],\n      resId: \"\"\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col min-h-screen overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(ResponsiveNavBar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"bg-gray-50  md:flex items-start justify-center pt-48 pb-44 md:px-6 px-4 \",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"xl:w-2/5 md:w-1/2 lg:ml-8 md:ml-6 md:mt-0 mt-6 bg-white px-8 py-10\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \" flex flex-row justify-center border-b border-gray-200 pb-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              class: \"lg:text-2xl text-xl font-semibold lg:leading-6 leading-7 text-gray-800 dark:text-white mt-2\",\n              children: this.state.offer.ville_depart\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"align-text-center pt-2 mx-10 text-2xl  font-bold\",\n              children: \" ------------------ \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n              class: \"right-0 lg:text-2xl text-xl font-semibold lg:leading-6 leading-7 text-gray-800 dark:text-white mt-2\",\n              children: this.state.offer.ville_arrivee\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"px-8 py-4 border-b border-gray-200 flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-4 w-4 mr-1\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                stroke: \"currentColor\",\n                strokeWidth: \"2\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  \"stroke-linecap\": \"round\",\n                  \"stroke-linejoin\": \"round\",\n                  d: \"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 125,\n                  columnNumber: 31\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 27\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\",\n                children: [\" \", this.state.offer.prix, \" DH\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 31\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 23\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-4 w-4 mr-1\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                stroke: \"currentColor\",\n                \"stroke-width\": \"2\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  \"stroke-linecap\": \"round\",\n                  \"stroke-linejoin\": \"round\",\n                  d: \"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 130,\n                columnNumber: 27\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\",\n                children: [\" \", this.state.date[0] + \"/\" + this.state.date[1] + \"/\" + (parseInt(this.state.date[2]) + 1)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 133,\n                columnNumber: 27\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                className: \"h-4 mr-1 w-4\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                stroke: \"currentColor\",\n                strokeWidth: 2,\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  d: \"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 138,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\",\n                children: [\" \", this.state.time.toLocaleString().split(\",\")[1]]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-4 mr-1 w-4\",\n                viewBox: \"0 0 20 20\",\n                fill: \"currentColor\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 144,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\",\n                children: this.state.offer.nombre_places\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 27\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"px-8 py-4 border-b border-gray-200 flex items-center justify-between\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: console.log(this.state.conducteur)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.ResrveOffer,\n            class: \"dark:bg-white  dark:text-gray-900 dark:hover:bg-cyan-100 w-auto focus:ring-2 focus:ring-offset-2 focus:ring-gray-800  flex items-center justify-center text-xl font-semibold leading-none text-white bg-cyan-600 px-8 mt-8 rounded  py-4 hover:bg-cyan-500 focus:outline-none\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              class: \"mr-3 dark:hidden\",\n              src: \"https://tuk-cdn.s3.amazonaws.com/can-uploader/svg1.svg\",\n              alt: \"location\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n              class: \"mr-3 hidden dark:block\",\n              src: \"https://tuk-cdn.s3.amazonaws.com/can-uploader/svg1dark.svg\",\n              alt: \"location\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 21\n            }, this), \"Book a place in this ride\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/MASHATE/Desktop/JS/React/frontend/src/pages/OfferPage.js"],"names":["React","Component","ResponsiveNavBar","axios","OfferPage","constructor","componentDidMount","fetchOffer","method","url","state","id","headers","then","res","status","getOffer","h","mm","s","data","time","split","y","m","d","Date","getTime","setState","offer","date","date_depart","ResrveOffer","toLocaleTimeString","str","sessionStorage","getItem","con","window","btoa","alert","resId","ville_depart","ville_arrivee","nombre_places","prix","id_annonces","is_added","location","href","conducteur","URLSearchParams","search","get","HMS","render","parseInt","toLocaleString","console","log"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,eAAe,MAAMC,SAAN,SAAwBH,SAAxB,CAAkC;AAE/CI,EAAAA,WAAW,GAAE;AACX;;AADW,SAabC,iBAba,GAaK,MAAI;AACpB,WAAKC,UAAL;AACD,KAfY;;AAAA,SAiBbA,UAjBa,GAiBC,MAAM;AAClBJ,MAAAA,KAAK,CAAC;AACJK,QAAAA,MAAM,EAAE,KADJ;AAEJC,QAAAA,GAAG,EAAE,uDAAqD,KAAKC,KAAL,CAAWC,EAFjE;AAGJC,QAAAA,OAAO,EAAE;AAAE,0BAAgB;AAAlB;AAHL,OAAD,CAAL,CAIOC,IAJP,CAIaC,GAAD,IAAS;AACX,YAAGA,GAAG,CAACC,MAAJ,KAAa,GAAhB,EAAoB;AAClB,eAAKC,QAAL;AACA,cAAG,CAACC,CAAD,EAAGC,EAAH,EAAMC,CAAN,IAAUL,GAAG,CAACM,IAAJ,CAASC,IAAT,CAAcC,KAAd,CAAoB,GAApB,EAAyB,CAAzB,EAA4BA,KAA5B,CAAkC,GAAlC,EAAuC,CAAvC,EAA0CA,KAA1C,CAAgD,GAAhD,CAAb;AACA,cAAI,CAACC,CAAD,EAAGC,CAAH,EAAKC,CAAL,IAASX,GAAG,CAACM,IAAJ,CAASC,IAAT,CAAcC,KAAd,CAAoB,GAApB,EAAyB,CAAzB,EAA4BA,KAA5B,CAAkC,GAAlC,CAAb;AACA,cAAID,IAAI,GAAC,IAAIK,IAAJ,CAASH,CAAT,EAAWC,CAAX,EAAaC,CAAb,EAAeR,CAAf,EAAiBC,EAAjB,EAAoBC,CAApB,EAAuBQ,OAAvB,EAAT;AACA,eAAKC,QAAL,CAAc;AACVC,YAAAA,KAAK,EAAEf,GAAG,CAACM,IADD;AAEVU,YAAAA,IAAI,EAAEhB,GAAG,CAACM,IAAJ,CAASW,WAAT,CAAqBT,KAArB,CAA2B,GAA3B,EAAgC,CAAhC,EAAmCA,KAAnC,CAAyC,GAAzC,CAFI;AAGVD,YAAAA,IAAI,EAAE,IAAIK,IAAJ,CAASZ,GAAG,CAACM,IAAJ,CAASC,IAAT,CAAcC,KAAd,CAAoB,GAApB,EAAyB,CAAzB,IAA4B,GAA5B,GAAgCR,GAAG,CAACM,IAAJ,CAASC,IAAT,CAAcC,KAAd,CAAoB,GAApB,EAAyB,CAAzB,EAA4BA,KAA5B,CAAkC,GAAlC,EAAuC,CAAvC,CAAzC;AAHI,WAAd;AAKH;AAAC,OAfV;AAkBD,KApCY;;AAAA,SAsCbU,WAtCa,GAsCD,MAAI;AACd,UAAIP,CAAC,GAAG,IAAIC,IAAJ,GAAWO,kBAAX,EAAR;AACA,YAAMC,GAAG,GAACC,cAAc,CAACC,OAAf,CAAuB,QAAvB,EAAiCd,KAAjC,CAAuC,GAAvC,EAA4C,CAA5C,IAA+C,GAA/C,GAAmDG,CAAnD,GAAqD,GAArD,GAAyD,KAAKf,KAAL,CAAWmB,KAAX,CAAiBQ,GAApF;AAEAlC,MAAAA,KAAK,CAAC;AACFK,QAAAA,MAAM,EAAE,MADN;AAEFC,QAAAA,GAAG,EAAE,uDAFH;AAGFW,QAAAA,IAAI,EAAE;AACJ,yBAAe,KAAKV,KAAL,CAAWC,EADtB;AAEJ,mBAAS2B,MAAM,CAACC,IAAP,CAAaL,GAAb,CAFL;AAGJ,uBAAaC,cAAc,CAACC,OAAf,CAAuB,QAAvB,EAAiCd,KAAjC,CAAuC,GAAvC,EAA4C,CAA5C;AAHT,SAHJ;AAQFV,QAAAA,OAAO,EAAE;AAAE,0BAAgB;AAAlB;AARP,OAAD,CAAL,CASGC,IATH,CASSC,GAAD,IAAQ;AACd,YAAGA,GAAG,CAACC,MAAJ,KAAa,GAAhB,EAAoB;AAClByB,UAAAA,KAAK,CAAC,uBAAD,CAAL;AACD,SAFD,MAGI;AACF,eAAKZ,QAAL,CAAc;AACZa,YAAAA,KAAK,EAAE3B,GAAG,CAACM;AADC,WAAd;AAGAjB,UAAAA,KAAK,CAAC;AACJK,YAAAA,MAAM,EAAE,KADJ;AAEJC,YAAAA,GAAG,EAAE,mDAFD;AAGJW,YAAAA,IAAI,EAAE;AACJsB,cAAAA,YAAY,EAAC,KAAKhC,KAAL,CAAWmB,KAAX,CAAiBa,YAD1B;AAEJC,cAAAA,aAAa,EAAC,KAAKjC,KAAL,CAAWmB,KAAX,CAAiBc,aAF3B;AAGJZ,cAAAA,WAAW,EAAC,KAAKrB,KAAL,CAAWmB,KAAX,CAAiBE,WAHzB;AAIJa,cAAAA,aAAa,EAAC,KAAKlC,KAAL,CAAWmB,KAAX,CAAiBe,aAAjB,GAA+B,CAJzC;AAKJC,cAAAA,IAAI,EAAC,KAAKnC,KAAL,CAAWmB,KAAX,CAAiBgB,IALlB;AAMJR,cAAAA,GAAG,EAAE,KAAK3B,KAAL,CAAWmB,KAAX,CAAiBQ,GANlB;AAOJ1B,cAAAA,EAAE,EAAC,KAAKD,KAAL,CAAWmB,KAAX,CAAiBQ,GAPhB;AAQJS,cAAAA,WAAW,EAAE,KAAKpC,KAAL,CAAWmB,KAAX,CAAiBiB;AAR1B,aAHF;AAaJlC,YAAAA,OAAO,EAAE;AAAE,8BAAgB;AAAlB;AAbL,WAAD,CAAL,CAcCC,IAdD,CAcOC,GAAD,IAAQ;AACd,gBAAGA,GAAG,CAACC,MAAJ,KAAa,GAAhB,EAAoB;AAClB,mBAAKa,QAAL,CAAc;AACZmB,gBAAAA,QAAQ,EAAE;AADE,eAAd;AAGAP,cAAAA,KAAK,CAAC,kDAAD,CAAL;AACAF,cAAAA,MAAM,CAACU,QAAP,CAAgBC,IAAhB,GAAuB,6BAA2B,KAAKvC,KAAL,CAAW+B,KAA7D;AACD;AACA,WAtBD;AAuBD;AACF,OAzCD;AA0CD,KApFY;;AAAA,SAsFbzB,QAtFa,GAsFJ,MAAI;AACXb,MAAAA,KAAK,CAAC;AACJK,QAAAA,MAAM,EAAE,KADJ;AAEJC,QAAAA,GAAG,EAAE,0DAAwD,KAAKC,KAAL,CAAWmB,KAAX,CAAiBQ,GAF1E;AAGJzB,QAAAA,OAAO,EAAE;AAAE,0BAAgB;AAAlB;AAHL,OAAD,CAAL,CAICC,IAJD,CAIOC,GAAD,IAAQ;AACd,YAAGA,GAAG,CAACC,MAAJ,KAAa,GAAhB,EAAoB;AAClB,eAAKa,QAAL,CAAc;AACZsB,YAAAA,UAAU,EAAEpC,GAAG,CAACM;AADJ,WAAd;AAGD;AACF,OAVC;AAYD,KAnGY;;AAEX,SAAKV,KAAL,GAAW;AACTC,MAAAA,EAAE,EAAC,IAAIwC,eAAJ,CAAoBb,MAAM,CAACU,QAAP,CAAgBI,MAApC,EAA4CC,GAA5C,CAAgD,IAAhD,CADM;AAETxB,MAAAA,KAAK,EAAE,EAFE;AAGTqB,MAAAA,UAAU,EAAE,EAHH;AAITpB,MAAAA,IAAI,EAAE,EAJG;AAKTT,MAAAA,IAAI,EAAE,IAAIK,IAAJ,EALG;AAMT4B,MAAAA,GAAG,EAAC,EANK;AAOTb,MAAAA,KAAK,EAAC;AAPG,KAAX;AASD;;AA0FDc,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,SAAS,EAAC,4CAAf;AAAA,8BAGA,QAAC,gBAAD;AAAA;AAAA;AAAA;AAAA,cAHA,eAKA;AAAK,QAAA,KAAK,EAAC,0EAAX;AAAA,+BACM;AAAK,UAAA,KAAK,EAAC,oEAAX;AAAA,kCACI;AAAK,YAAA,KAAK,EAAC,6DAAX;AAAA,oCACI;AAAI,cAAA,KAAK,EAAC,6FAAV;AAAA,wBAAyG,KAAK7C,KAAL,CAAWmB,KAAX,CAAiBa;AAA1H;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AAAG,cAAA,SAAS,EAAC,kDAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFJ,eAGI;AAAI,cAAA,KAAK,EAAC,qGAAV;AAAA,wBAAiH,KAAKhC,KAAL,CAAWmB,KAAX,CAAiBc;AAAlI;AAAA;AAAA;AAAA;AAAA,oBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAMI;AAAK,YAAA,KAAK,EAAC,sEAAX;AAAA,oCACM;AAAK,cAAA,KAAK,EAAC,kCAAX;AAAA,sCACI;AAAK,gBAAA,KAAK,EAAC,4BAAX;AAAwC,gBAAA,KAAK,EAAC,cAA9C;AAA6D,gBAAA,IAAI,EAAC,MAAlE;AAAyE,gBAAA,OAAO,EAAC,WAAjF;AAA6F,gBAAA,MAAM,EAAC,cAApG;AAAmH,gBAAA,WAAW,EAAC,GAA/H;AAAA,uCACI;AAAM,oCAAe,OAArB;AAA6B,qCAAgB,OAA7C;AAAqD,kBAAA,CAAC,EAAC;AAAvD;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,sBADJ,eAIQ;AAAM,gBAAA,SAAS,EAAC,iFAAhB;AAAA,gCAAoG,KAAKjC,KAAL,CAAWmB,KAAX,CAAiBgB,IAArH;AAAA;AAAA;AAAA;AAAA;AAAA,sBAJR;AAAA;AAAA;AAAA;AAAA;AAAA,oBADN,eAOE;AAAK,cAAA,KAAK,EAAC,kCAAX;AAAA,sCACQ;AAAK,gBAAA,KAAK,EAAC,4BAAX;AAAwC,gBAAA,KAAK,EAAC,cAA9C;AAA6D,gBAAA,IAAI,EAAC,MAAlE;AAAyE,gBAAA,OAAO,EAAC,WAAjF;AAA6F,gBAAA,MAAM,EAAC,cAApG;AAAmH,gCAAa,GAAhI;AAAA,uCACE;AAAM,oCAAe,OAArB;AAA6B,qCAAgB,OAA7C;AAAqD,kBAAA,CAAC,EAAC;AAAvD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,sBADR,eAIQ;AAAM,gBAAA,SAAS,EAAC,iFAAhB;AAAA,gCAAoG,KAAKnC,KAAL,CAAWoB,IAAX,CAAgB,CAAhB,IAAmB,GAAnB,GAAuB,KAAKpB,KAAL,CAAWoB,IAAX,CAAgB,CAAhB,CAAvB,GAA0C,GAA1C,IAA+C0B,QAAQ,CAAC,KAAK9C,KAAL,CAAWoB,IAAX,CAAgB,CAAhB,CAAD,CAAR,GAA6B,CAA5E,CAApG;AAAA;AAAA;AAAA;AAAA;AAAA,sBAJR;AAAA;AAAA;AAAA;AAAA;AAAA,oBAPF,eAcI;AAAK,cAAA,KAAK,EAAC,kCAAX;AAAA,sCACQ;AAAK,gBAAA,KAAK,EAAC,4BAAX;AAAwC,gBAAA,SAAS,EAAC,cAAlD;AAAiE,gBAAA,IAAI,EAAC,MAAtE;AAA6E,gBAAA,OAAO,EAAC,WAArF;AAAiG,gBAAA,MAAM,EAAC,cAAxG;AAAuH,gBAAA,WAAW,EAAE,CAApI;AAAA,uCACA;AAAM,kBAAA,aAAa,EAAC,OAApB;AAA4B,kBAAA,cAAc,EAAC,OAA3C;AAAmD,kBAAA,CAAC,EAAC;AAArD;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,sBADR,eAIQ;AAAM,gBAAA,SAAS,EAAC,iFAAhB;AAAA,gCAAoG,KAAKpB,KAAL,CAAWW,IAAX,CAAgBoC,cAAhB,GAAiCnC,KAAjC,CAAuC,GAAvC,EAA4C,CAA5C,CAApG;AAAA;AAAA;AAAA;AAAA;AAAA,sBAJR;AAAA;AAAA;AAAA;AAAA;AAAA,oBAdJ,eAoBI;AAAK,cAAA,SAAS,EAAC,kCAAf;AAAA,sCACA;AAAK,gBAAA,KAAK,EAAC,4BAAX;AAAwC,gBAAA,KAAK,EAAC,cAA9C;AAA6D,gBAAA,OAAO,EAAC,WAArE;AAAiF,gBAAA,IAAI,EAAC,cAAtF;AAAA,uCACA;AAAM,kBAAA,CAAC,EAAC;AAAR;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,sBADA,eAIM;AAAG,gBAAA,SAAS,EAAC,iFAAb;AAAA,0BAAgG,KAAKZ,KAAL,CAAWmB,KAAX,CAAiBe;AAAjH;AAAA;AAAA;AAAA;AAAA,sBAJN;AAAA;AAAA;AAAA;AAAA;AAAA,oBApBJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBANJ,eAiCI;AAAK,YAAA,KAAK,EAAC,sEAAX;AAAA,mCACE;AAAA,wBACGc,OAAO,CAACC,GAAR,CAAY,KAAKjD,KAAL,CAAWwC,UAAvB;AADH;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAjCJ,eAuCI;AAAQ,YAAA,OAAO,EAAE,KAAKlB,WAAtB;AAAmC,YAAA,KAAK,EAAC,+QAAzC;AAAA,oCACI;AAAK,cAAA,KAAK,EAAC,kBAAX;AAA8B,cAAA,GAAG,EAAC,wDAAlC;AAA2F,cAAA,GAAG,EAAC;AAA/F;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AAAK,cAAA,KAAK,EAAC,wBAAX;AAAoC,cAAA,GAAG,EAAC,4DAAxC;AAAqG,cAAA,GAAG,EAAC;AAAzG;AAAA;AAAA;AAAA;AAAA,oBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBAvCJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADN;AAAA;AAAA;AAAA;AAAA,cALA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;AA0DD;;AAlK8C","sourcesContent":["import React, { Component } from 'react'\r\nimport ResponsiveNavBar from \"../Partials/Header\"\r\nimport axios from 'axios'\r\n\r\nexport default class OfferPage extends Component {\r\n\r\n  constructor(){\r\n    super()\r\n    this.state={\r\n      id:new URLSearchParams(window.location.search).get('id'),\r\n      offer: {},\r\n      conducteur: {},\r\n      date: [],\r\n      time: new Date(),\r\n      HMS:[],\r\n      resId:\"\"\r\n    }\r\n  }\r\n\r\n  componentDidMount=()=>{\r\n    this.fetchOffer()\r\n  }\r\n\r\n  fetchOffer =  () => {\r\n    axios({\r\n      method: \"GET\",\r\n      url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/annonces/\"+this.state.id,\r\n      headers: { \"Content-Type\": \"Application/json\"},\r\n        }).then((res) => {\r\n              if(res.status===200){\r\n                this.getOffer()\r\n                let[h,mm,s] =res.data.time.split(\"T\")[1].split('Z')[0].split(\":\")\r\n                let [y,m,d] =res.data.time.split(\"T\")[0].split(\"-\")\r\n                let time=new Date(y,m,d,h,mm,s).getTime()\r\n                this.setState({\r\n                    offer: res.data,\r\n                    date: res.data.date_depart.split('Z')[0].split(\"-\"),\r\n                    time: new Date(res.data.time.split(\"T\")[0]+\" \"+res.data.time.split(\"T\")[1].split(\"Z\")[0]),\r\n                  })\r\n            }});\r\n      \r\n\r\n  }\r\n\r\n  ResrveOffer=()=>{\r\n    let d = new Date().toLocaleTimeString()\r\n    const str=sessionStorage.getItem(\"userID\").split(\"@\")[1]+\"@\"+d+\"@\"+this.state.offer.con\r\n\r\n    axios({\r\n        method: \"POST\",\r\n        url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/reservations\",\r\n        data: {\r\n          \"id_annonces\": this.state.id,\r\n          \"resId\": window.btoa( str ),\r\n          \"userlogin\": sessionStorage.getItem(\"userID\").split(\"@\")[1]\r\n      },\r\n        headers: { \"Content-Type\": \"Application/json\"},\r\n    }).then((res) =>{\r\n      if(res.status!==200){\r\n        alert(\"Error: can't book X( \")\r\n      }\r\n      else{\r\n        this.setState({\r\n          resId: res.data\r\n        })\r\n        axios({\r\n          method: \"PUT\",\r\n          url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/annonces\",\r\n          data: {\r\n            ville_depart:this.state.offer.ville_depart,\r\n            ville_arrivee:this.state.offer.ville_arrivee,\r\n            date_depart:this.state.offer.date_depart,\r\n            nombre_places:this.state.offer.nombre_places-1,\r\n            prix:this.state.offer.prix,\r\n            con: this.state.offer.con,\r\n            id:this.state.offer.con,\r\n            id_annonces: this.state.offer.id_annonces,\r\n        },\r\n          headers: { \"Content-Type\": \"Application/json\"},\r\n      }).then((res) =>{\r\n        if(res.status===200){\r\n          this.setState({\r\n            is_added: true\r\n          })\r\n          alert(\"Congrats, you booked your place in this ride :) \")\r\n          window.location.href = \"/ride/bookedOffer?resID=\"+this.state.resId;\r\n        }\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  getOffer=()=>{\r\n    axios({\r\n      method: \"GET\",\r\n      url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/conducteurs/\"+this.state.offer.con,\r\n      headers: { \"Content-Type\": \"Application/json\"},\r\n  }).then((res) =>{\r\n    if(res.status!==200){\r\n      this.setState({\r\n        conducteur: res.data\r\n      })\r\n    }\r\n  })\r\n\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"flex flex-col min-h-screen overflow-hidden\">\r\n\r\n      {/*  Site header */}\r\n      <ResponsiveNavBar />\r\n      \r\n      <div class=\"bg-gray-50  md:flex items-start justify-center pt-48 pb-44 md:px-6 px-4 \">\r\n            <div class=\"xl:w-2/5 md:w-1/2 lg:ml-8 md:ml-6 md:mt-0 mt-6 bg-white px-8 py-10\">\r\n                <div class=\" flex flex-row justify-center border-b border-gray-200 pb-6\" >\r\n                    <h1 class=\"lg:text-2xl text-xl font-semibold lg:leading-6 leading-7 text-gray-800 dark:text-white mt-2\">{this.state.offer.ville_depart}</h1>\r\n                    <p className='align-text-center pt-2 mx-10 text-2xl  font-bold'> ------------------ </p>\r\n                    <h1 class=\"right-0 lg:text-2xl text-xl font-semibold lg:leading-6 leading-7 text-gray-800 dark:text-white mt-2\">{this.state.offer.ville_arrivee}</h1>\r\n                </div>\r\n                <div class=\"px-8 py-4 border-b border-gray-200 flex items-center justify-between\">\r\n                      <div class=\"flex items-center  text-gray-700\" >\r\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z\" />\r\n                              </svg>\r\n                              <span className='py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded'> {this.state.offer.prix} DH</span>\r\n                  </div>\r\n                  <div class=\"flex items-center  text-gray-700\" >\r\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\r\n                          </svg>\r\n                          <span className='py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded'> {this.state.date[0]+\"/\"+this.state.date[1]+\"/\"+(parseInt(this.state.date[2])+1)}</span>\r\n                  </div>\r\n\r\n                    <div class=\"flex items-center  text-gray-700\" >\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 mr-1 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                          </svg>\r\n                            <span className='py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded'> {this.state.time.toLocaleString().split(\",\")[1]}</span>\r\n                    </div>\r\n                    <div className=\"flex items-center  text-gray-700\">\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 mr-1 w-4\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                    <path d=\"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z\" />\r\n                    </svg>\r\n                          <p className=\"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\">{this.state.offer.nombre_places}</p>\r\n                </div>\r\n                </div>\r\n                <div class=\"px-8 py-4 border-b border-gray-200 flex items-center justify-between\">\r\n                  <div>\r\n                    {console.log(this.state.conducteur)}\r\n                  </div>\r\n                </div>\r\n                \r\n                <button onClick={this.ResrveOffer} class=\"dark:bg-white  dark:text-gray-900 dark:hover:bg-cyan-100 w-auto focus:ring-2 focus:ring-offset-2 focus:ring-gray-800  flex items-center justify-center text-xl font-semibold leading-none text-white bg-cyan-600 px-8 mt-8 rounded  py-4 hover:bg-cyan-500 focus:outline-none\">\r\n                    <img class=\"mr-3 dark:hidden\" src=\"https://tuk-cdn.s3.amazonaws.com/can-uploader/svg1.svg\" alt=\"location\" />\r\n                    <img class=\"mr-3 hidden dark:block\" src=\"https://tuk-cdn.s3.amazonaws.com/can-uploader/svg1dark.svg\" alt=\"location\" />\r\n                    Book a place in this ride\r\n                </button>\r\n\r\n            </div>\r\n        </div>\r\n        \r\n\r\n    </div>\r\n    )\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}