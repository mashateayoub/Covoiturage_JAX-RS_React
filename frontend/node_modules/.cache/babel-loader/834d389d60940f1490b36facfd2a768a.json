{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MASHATE\\\\Desktop\\\\JS\\\\React\\\\frontend\\\\src\\\\pages\\\\OfferPage.js\";\nimport React, { Component } from 'react';\nimport ResponsiveNavBar from \"../Partials/Header\";\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class OfferPage extends Component {\n  constructor() {\n    super();\n\n    this.componentDidMount = () => {\n      this.fetchOffer();\n    };\n\n    this.fetchOffer = () => {\n      axios({\n        method: \"GET\",\n        url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/annonces/\" + this.state.id,\n        headers: {\n          \"Content-Type\": \"Application/json\"\n        }\n      }).then(res => {\n        if (res.status === 200) {\n          let [h, mm, s] = res.data.time.split(\"T\")[1].split('Z')[0].split(\":\");\n          let [y, m, d] = res.data.time.split(\"T\")[0].split(\"-\");\n          let time = new Date(y, m, d, h, mm, s).getTime();\n          this.setState({\n            offer: res.data,\n            date: res.data.date_depart.split('Z')[0].split(\"-\"),\n            time: new Date(res.data.time.split(\"T\")[0] + \" \" + res.data.time.split(\"T\")[1].split(\"Z\")[0])\n          });\n          this.getCon(res.data.con);\n        }\n      });\n    };\n\n    this.ResrveOffer = () => {\n      let d = new Date().toLocaleTimeString();\n      const str = sessionStorage.getItem(\"userID\").split(\"@\")[1] + \"@\" + d + \"@\" + this.state.offer.con;\n      axios({\n        method: \"POST\",\n        url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/reservations\",\n        data: {\n          \"id_annonces\": this.state.id,\n          \"resId\": window.btoa(str),\n          \"userlogin\": sessionStorage.getItem(\"userID\").split(\"@\")[1],\n          \"confirmed\": false\n        },\n        headers: {\n          \"Content-Type\": \"Application/json\"\n        }\n      }).then(res => {\n        if (res.status !== 200) {\n          alert(\"Error: can't book X( \");\n        } else {\n          this.setState({\n            resId: res.data\n          });\n          axios({\n            method: \"PUT\",\n            url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/annonces\",\n            data: {\n              ville_depart: this.state.offer.ville_depart,\n              ville_arrivee: this.state.offer.ville_arrivee,\n              date_depart: this.state.offer.date_depart,\n              nombre_places: this.state.offer.nombre_places - 1,\n              prix: this.state.offer.prix,\n              con: this.state.offer.con,\n              id: this.state.offer.con,\n              id_annonces: this.state.offer.id_annonces\n            },\n            headers: {\n              \"Content-Type\": \"Application/json\"\n            }\n          }).then(res => {\n            if (res.status === 200) {\n              this.setState({\n                is_added: true\n              });\n              alert(\"Congrats, you booked your place in this ride :) \");\n              window.location.href = \"/ride/bookedOffer?resID=\" + this.state.resId;\n            }\n          });\n        }\n      });\n    };\n\n    this.getCon = con => {\n      axios({\n        method: \"GET\",\n        url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/conducteurs/\" + con,\n        headers: {\n          \"Content-Type\": \"Application/json\"\n        }\n      }).then(res => {\n        if (res.status === 200) {\n          this.setState({\n            conducteur: res.data\n          });\n        }\n      });\n    };\n\n    this.state = {\n      id: new URLSearchParams(window.location.search).get('id'),\n      offer: {},\n      conducteur: {},\n      date: [],\n      time: new Date(),\n      HMS: [],\n      resId: \"\"\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col min-h-screen overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(ResponsiveNavBar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"bg-gray-50  md:flex items-start justify-center pt-32 pb-44 md:px-6 px-4 \",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"xl:w-2/5 md:w-1/2 lg:ml-8 md:ml-6 md:mt-0 mt-6 bg-white px-8 py-10\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \" flex flex-row justify-center border-b border-gray-200 pb-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              class: \"lg:text-2xl text-xl font-semibold lg:leading-6 leading-7 text-gray-800 dark:text-white mt-2\",\n              children: this.state.offer.ville_depart\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"align-text-center pt-2 mx-10 text-2xl  font-bold\",\n              children: \" ------------------ \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n              class: \"right-0 lg:text-2xl text-xl font-semibold lg:leading-6 leading-7 text-gray-800 dark:text-white mt-2\",\n              children: this.state.offer.ville_arrivee\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"px-8 py-4 border-b border-gray-200 flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-4 w-4 mr-1\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                stroke: \"currentColor\",\n                strokeWidth: \"2\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  \"stroke-linecap\": \"round\",\n                  \"stroke-linejoin\": \"round\",\n                  d: \"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 132,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\",\n                children: [\" \", this.state.offer.prix, \" DH\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 134,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-4 w-4 mr-1\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                stroke: \"currentColor\",\n                \"stroke-width\": \"2\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  \"stroke-linecap\": \"round\",\n                  \"stroke-linejoin\": \"round\",\n                  d: \"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 138,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\",\n                children: [\" \", this.state.date[0] + \"/\" + this.state.date[1] + \"/\" + (parseInt(this.state.date[2]) + 1)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                className: \"h-4 mr-1 w-4\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                stroke: \"currentColor\",\n                strokeWidth: 2,\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  d: \"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\",\n                children: [\" \", this.state.time.toLocaleString().split(\",\")[1]]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-4 mr-1 w-4\",\n                viewBox: \"0 0 20 20\",\n                fill: \"currentColor\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 151,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\",\n                children: this.state.offer.nombre_places\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"px-8 py-4 border-b border-gray-200 flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-8 w-8 mr-2\",\n                viewBox: \"0 0 20 20\",\n                fill: \"currentColor\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  \"fill-rule\": \"evenodd\",\n                  d: \"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z\",\n                  \"clip-rule\": \"evenodd\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 17\n              }, this), this.state.conducteur.nom, \" \", this.state.conducteur.prenom]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center  text-gray-700\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                xmlns: \"http://www.w3.org/2000/svg\",\n                class: \"h-6 w-6 mr-2\",\n                fill: \"none\",\n                viewBox: \"0 0 24 24\",\n                stroke: \"currentColor\",\n                \"stroke-width\": \"2\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  \"stroke-linecap\": \"round\",\n                  \"stroke-linejoin\": \"round\",\n                  d: \"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 165,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 17\n              }, this), this.state.conducteur.tel]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.ResrveOffer,\n            class: \"dark:bg-white  dark:text-gray-900 dark:hover:bg-cyan-100 w-auto focus:ring-2 focus:ring-offset-2 focus:ring-gray-800  flex items-center justify-center text-xl font-semibold leading-none text-white bg-cyan-600 px-8 mt-8 rounded  py-4 hover:bg-cyan-500 focus:outline-none\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              class: \"mr-3 dark:hidden\",\n              src: \"https://tuk-cdn.s3.amazonaws.com/can-uploader/svg1.svg\",\n              alt: \"location\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n              class: \"mr-3 hidden dark:block\",\n              src: \"https://tuk-cdn.s3.amazonaws.com/can-uploader/svg1dark.svg\",\n              alt: \"location\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 15\n            }, this), \"Book a place in this ride\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/MASHATE/Desktop/JS/React/frontend/src/pages/OfferPage.js"],"names":["React","Component","ResponsiveNavBar","axios","OfferPage","constructor","componentDidMount","fetchOffer","method","url","state","id","headers","then","res","status","h","mm","s","data","time","split","y","m","d","Date","getTime","setState","offer","date","date_depart","getCon","con","ResrveOffer","toLocaleTimeString","str","sessionStorage","getItem","window","btoa","alert","resId","ville_depart","ville_arrivee","nombre_places","prix","id_annonces","is_added","location","href","conducteur","URLSearchParams","search","get","HMS","render","parseInt","toLocaleString","nom","prenom","tel"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport ResponsiveNavBar from \"../Partials/Header\"\r\nimport axios from 'axios'\r\n\r\nexport default class OfferPage extends Component {\r\n\r\n  constructor() {\r\n    super()\r\n    this.state = {\r\n      id: new URLSearchParams(window.location.search).get('id'),\r\n      offer: {},\r\n      conducteur: {},\r\n      date: [],\r\n      time: new Date(),\r\n      HMS: [],\r\n      resId: \"\"\r\n    }\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    this.fetchOffer()\r\n\r\n  }\r\n\r\n  fetchOffer = () => {\r\n    axios({\r\n      method: \"GET\",\r\n      url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/annonces/\" + this.state.id,\r\n      headers: { \"Content-Type\": \"Application/json\" },\r\n    }).then((res) => {\r\n      if (res.status === 200) {\r\n\r\n        let [h, mm, s] = res.data.time.split(\"T\")[1].split('Z')[0].split(\":\")\r\n        let [y, m, d] = res.data.time.split(\"T\")[0].split(\"-\")\r\n        let time = new Date(y, m, d, h, mm, s).getTime()\r\n        this.setState({\r\n          offer: res.data,\r\n          date: res.data.date_depart.split('Z')[0].split(\"-\"),\r\n          time: new Date(res.data.time.split(\"T\")[0] + \" \" + res.data.time.split(\"T\")[1].split(\"Z\")[0]),\r\n        })\r\n        this.getCon(res.data.con)\r\n\r\n      }\r\n    });\r\n\r\n\r\n\r\n\r\n  }\r\n\r\n  ResrveOffer = () => {\r\n    let d = new Date().toLocaleTimeString()\r\n    const str = sessionStorage.getItem(\"userID\").split(\"@\")[1] + \"@\" + d + \"@\" + this.state.offer.con\r\n\r\n    axios({\r\n      method: \"POST\",\r\n      url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/reservations\",\r\n      data: {\r\n        \"id_annonces\": this.state.id,\r\n        \"resId\": window.btoa(str),\r\n        \"userlogin\": sessionStorage.getItem(\"userID\").split(\"@\")[1],\r\n        \"confirmed\": false,\r\n      },\r\n      headers: { \"Content-Type\": \"Application/json\" },\r\n    }).then((res) => {\r\n      if (res.status !== 200) {\r\n        alert(\"Error: can't book X( \")\r\n      }\r\n      else {\r\n        this.setState({\r\n          resId: res.data\r\n        })\r\n        axios({\r\n          method: \"PUT\",\r\n          url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/annonces\",\r\n          data: {\r\n            ville_depart: this.state.offer.ville_depart,\r\n            ville_arrivee: this.state.offer.ville_arrivee,\r\n            date_depart: this.state.offer.date_depart,\r\n            nombre_places: this.state.offer.nombre_places - 1,\r\n            prix: this.state.offer.prix,\r\n            con: this.state.offer.con,\r\n            id: this.state.offer.con,\r\n            id_annonces: this.state.offer.id_annonces,\r\n          },\r\n          headers: { \"Content-Type\": \"Application/json\" },\r\n        }).then((res) => {\r\n          if (res.status === 200) {\r\n            this.setState({\r\n              is_added: true\r\n            })\r\n            alert(\"Congrats, you booked your place in this ride :) \")\r\n            window.location.href = \"/ride/bookedOffer?resID=\" + this.state.resId;\r\n          }\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  getCon = (con) => {\r\n    axios({\r\n      method: \"GET\",\r\n      url: \"http://127.0.0.1:8080/EJB-Client/APIv1.0/conducteurs/\" + con,\r\n      headers: { \"Content-Type\": \"Application/json\" },\r\n    }).then((res) => {\r\n      if (res.status === 200) {\r\n        this.setState({\r\n          conducteur: res.data\r\n        })\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"flex flex-col min-h-screen overflow-hidden\">\r\n\r\n        {/*  Site header */}\r\n        <ResponsiveNavBar />\r\n\r\n        <div class=\"bg-gray-50  md:flex items-start justify-center pt-32 pb-44 md:px-6 px-4 \">\r\n          <div class=\"xl:w-2/5 md:w-1/2 lg:ml-8 md:ml-6 md:mt-0 mt-6 bg-white px-8 py-10\">\r\n            <div class=\" flex flex-row justify-center border-b border-gray-200 pb-6\" >\r\n              <h1 class=\"lg:text-2xl text-xl font-semibold lg:leading-6 leading-7 text-gray-800 dark:text-white mt-2\">{this.state.offer.ville_depart}</h1>\r\n              <p className='align-text-center pt-2 mx-10 text-2xl  font-bold'> ------------------ </p>\r\n              <h1 class=\"right-0 lg:text-2xl text-xl font-semibold lg:leading-6 leading-7 text-gray-800 dark:text-white mt-2\">{this.state.offer.ville_arrivee}</h1>\r\n            </div>\r\n            <div class=\"px-8 py-4 border-b border-gray-200 flex items-center justify-between\">\r\n              <div class=\"flex items-center  text-gray-700\" >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z\" />\r\n                </svg>\r\n                <span className='py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded'> {this.state.offer.prix} DH</span>\r\n              </div>\r\n              <div class=\"flex items-center  text-gray-700\" >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\r\n                </svg>\r\n                <span className='py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded'> {this.state.date[0] + \"/\" + this.state.date[1] + \"/\" + (parseInt(this.state.date[2]) + 1)}</span>\r\n              </div>\r\n\r\n              <div class=\"flex items-center  text-gray-700\" >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 mr-1 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                </svg>\r\n                <span className='py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded'> {this.state.time.toLocaleString().split(\",\")[1]}</span>\r\n              </div>\r\n              <div className=\"flex items-center  text-gray-700\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 mr-1 w-4\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path d=\"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z\" />\r\n                </svg>\r\n                <p className=\"py-3 px-3 text-sm focus:outline-none leading-none  italic font-semibold rounded\">{this.state.offer.nombre_places}</p>\r\n              </div>\r\n            </div >\r\n            <div class=\"px-8 py-4 border-b border-gray-200 flex items-center justify-between\">\r\n              <div className=\"flex items-center  text-gray-700\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-8 w-8 mr-2\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z\" clip-rule=\"evenodd\" />\r\n                </svg>\r\n                {this.state.conducteur.nom} {this.state.conducteur.prenom}\r\n              </div>\r\n              <div className=\"flex items-center  text-gray-700\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-6 w-6 mr-2\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\r\n                </svg>\r\n                {this.state.conducteur.tel}\r\n              </div>\r\n            </div>\r\n\r\n            <button onClick={this.ResrveOffer} class=\"dark:bg-white  dark:text-gray-900 dark:hover:bg-cyan-100 w-auto focus:ring-2 focus:ring-offset-2 focus:ring-gray-800  flex items-center justify-center text-xl font-semibold leading-none text-white bg-cyan-600 px-8 mt-8 rounded  py-4 hover:bg-cyan-500 focus:outline-none\">\r\n              <img class=\"mr-3 dark:hidden\" src=\"https://tuk-cdn.s3.amazonaws.com/can-uploader/svg1.svg\" alt=\"location\" />\r\n              <img class=\"mr-3 hidden dark:block\" src=\"https://tuk-cdn.s3.amazonaws.com/can-uploader/svg1dark.svg\" alt=\"location\" />\r\n              Book a place in this ride\r\n            </button>\r\n\r\n          </div>\r\n        </div>\r\n\r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}